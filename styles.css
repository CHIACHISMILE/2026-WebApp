/* =========================================================
   Nordic Apple-like Pastel (v7)
   - Fix iOS PWA header under Dynamic Island
   - Itinerary cards: no gradient + left color bar
   - Improve budget card readability
   ========================================================= */

:root{
  --bg-0:#f4fbff;
  --bg-1:#eef6ff;

  --ink-0:#07131f;
  --ink-1:rgba(7,19,31,.88);
  --ink-2:rgba(7,19,31,.68);
  --ink-3:rgba(7,19,31,.50);

  --glass:rgba(255,255,255,.74);
  --glass-strong:rgba(255,255,255,.92);
  --glass-border:rgba(10,25,45,.14);
  --shadow:0 12px 38px rgba(10,25,45,.10);

  --radius-xl:22px;
  --radius-lg:18px;
  --radius-md:14px;

  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);

  /* macaron palette */
  --sky:#7bb7ff;
  --lav:#b8b1ff;
  --mint:#7fe0c4;
  --peach:#ffb79f;
  --butter:#ffd87a;
  --rose:#ff9fbe;
  --slate:#7d93a6;

  /* Itinerary category bars */
  --it-sight:#7bb7ff;   /* 景點 */
  --it-food:#ffb79f;    /* 飲食 */
  --it-traffic:#b8b1ff; /* 交通 */
  --it-stay:#7fe0c4;    /* 住宿 */
  --it-other:#ff9fbe;   /* 其他 */
}

*{box-sizing:border-box;}
html,body{height:100%;}
body{
  margin:0;
  color:var(--ink-0);
  background:
    radial-gradient(1100px 800px at 20% 0%, rgba(215,239,255,.95) 0%, rgba(215,239,255,0) 58%),
    radial-gradient(900px 700px at 85% 10%, rgba(207,242,233,.90) 0%, rgba(207,242,233,0) 58%),
    linear-gradient(180deg, var(--bg-0), var(--bg-1));
  -webkit-font-smoothing:antialiased;
}

.app-shell{min-height:100vh;display:flex;flex-direction:column;}
.safe-bottom{display:none!important;height:0!important;}

/* force legibility */
.text-slate-50,
.text-slate-200\/90,
.text-slate-200\/80,
.text-slate-300\/80{
  color: var(--ink-1) !important;
}

/* ===== Header: iOS PWA Dynamic Island safe =====
   Use safe-top + extra padding so title never goes behind island/notch. */
.app-header{
  position:sticky;
  top:0;
  z-index:30;
  padding-top:calc(var(--safe-top) + 44px);
  padding-bottom:14px;
  background:linear-gradient(180deg, rgba(244,251,255,.96), rgba(244,251,255,.82));
  backdrop-filter:blur(16px);
  -webkit-backdrop-filter:blur(16px);
  border-bottom:1px solid rgba(10,25,45,.10);
}
.app-header h1{color:var(--ink-0)!important;}

#syncStatus .text-sm{color:var(--ink-0)!important;font-weight:900;}

.pill{
  display:inline-flex;align-items:center;gap:8px;
  padding:6px 12px;border-radius:999px;
  font-size:12px;font-weight:900;
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.88);
  color:var(--ink-1);
  box-shadow:0 10px 26px rgba(10,25,45,.10);
}
.pill-sky{background:rgba(123,183,255,.22);border-color:rgba(123,183,255,.30);color:var(--ink-0);}
.pill-ice{background:rgba(255,255,255,.90);}

.dot{width:10px;height:10px;border-radius:999px;display:inline-block;box-shadow:0 0 0 3px rgba(255,255,255,.95);}
.dot-ok{background:var(--mint);}
.dot-sync{background:var(--sky);}
.dot-offline{background:var(--slate);}
.dot-wait{background:var(--butter);}

.app-content{flex:1;display:flex;flex-direction:column;}

/* tabbar stays below header - already fine */
.tabbar{
  position:sticky;
  top:calc(var(--safe-top) + 44px + 92px);
  z-index:25;
  padding:10px 12px;
  background:rgba(244,251,255,.86);
  backdrop-filter:blur(16px);
  -webkit-backdrop-filter:blur(16px);
  border-bottom:1px solid rgba(10,25,45,.10);
  display:flex;gap:10px;
}
.tab{
  flex:1;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(10,25,45,.12);
  background:rgba(255,255,255,.84);
  color:var(--ink-1);
  font-size:14px;font-weight:900;
}
.tab.active{
  background:rgba(123,183,255,.22);
  border-color:rgba(123,183,255,.30);
  color:var(--ink-0);
}

.card{
  background:var(--glass);
  border:1px solid var(--glass-border);
  border-radius:var(--radius-xl);
  box-shadow:var(--shadow);
}

.btn{
  border-radius:999px;
  border:1px solid rgba(10,25,45,.14);
  padding:10px 14px;
  font-weight:900;
  color:var(--ink-0);
  background:rgba(255,255,255,.86);
  box-shadow:0 10px 26px rgba(10,25,45,.10);
}
.btn:active{transform:translateY(1px);}
.btn-primary{background:rgba(123,183,255,.22);border-color:rgba(123,183,255,.30);}
.btn-outline{background:rgba(255,255,255,.82);}
.btn-ghost{background:transparent;box-shadow:none;}

.field-label{font-size:12px;font-weight:900;color:var(--ink-2);}
.field-input{
  margin-top:6px;width:100%;
  border-radius:var(--radius-md);
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.92);
  padding:12px 12px;
  font-size:14px;
  color:var(--ink-0);
  outline:none;
}
.field-input:focus{
  border-color:rgba(123,183,255,.46);
  box-shadow:0 0 0 4px rgba(123,183,255,.18);
}

/* time input smaller */
.time-input{width:100%;padding:8px 6px;font-size:14px;}

.editable{
  margin-top:6px;
  min-height:46px;
  padding:12px 12px;
  border-radius:var(--radius-md);
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.92);
  color:var(--ink-0);
  outline:none;
}
.editable:empty:before{content:attr(placeholder);color:rgba(7,19,31,.40);}

/* Date strip */
.date-strip{
  display:flex;overflow-x:auto;gap:10px;
  padding:6px 2px;
  -webkit-overflow-scrolling:touch;
  scroll-snap-type:x mandatory;
}
.date-strip::-webkit-scrollbar{display:none;}
.date-chip{
  flex:0 0 auto;
  scroll-snap-align:center;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(10,25,45,.12);
  background:rgba(255,255,255,.84);
  font-size:12px;font-weight:900;
  color:var(--ink-1);
}
.date-chip.active{
  background:rgba(123,183,255,.22);
  border-color:rgba(123,183,255,.30);
  color:var(--ink-0);
}

/* Tags */
.tag{
  display:inline-flex;align-items:center;
  padding:8px 12px;
  border-radius:999px;
  font-size:12px;font-weight:900;
  border:1px solid rgba(10,25,45,.12);
  color:var(--ink-0);
}

/* Pending */
.pending-card{border:2px dashed rgba(211,154,75,.9)!important;}
.pending-badge{
  padding:2px 8px;border-radius:999px;
  border:1px dashed rgba(211,154,75,.9);
  color:rgba(110,70,10,.92);
  background:rgba(255,255,255,.86);
  font-weight:900;
}

/* ===== Itinerary cards: NO gradient, add left bar ===== */
.it-card{
  position:relative;
  padding-left:16px; /* room for bar */
  background:rgba(255,255,255,.72);
}
/* ===== Itinerary cards: NO gradient, add left bar (fix overlap) ===== */
.it-card{
  position:relative;
  padding-left:20px;             /* ✅ 더留空間 */
  background:rgba(255,255,255,.72);
  overflow:hidden;               /* ✅ bar 不會跑出去 */
}
.it-card::before{
  content:"";
  position:absolute;
  left:0;                        /* ✅ 沿卡片左邊界 */
  top:0;
  bottom:0;
  width:8px;                     /* ✅ 明顯但不吃字 */
  border-radius:0;               /* ✅ 沿邊界直條 */
  background:var(--it-other);
  box-shadow:none;
}
.it-sight::before{ background:var(--it-sight); }
.it-food::before{ background:var(--it-food); }
.it-traffic::before{ background:var(--it-traffic); }
.it-stay::before{ background:var(--it-stay); }
.it-other::before{ background:var(--it-other); }

/* Itinerary tags keep color */
.tag-it-sight{ background:rgba(123,183,255,.22); border-color:rgba(123,183,255,.30); }
.tag-it-food{  background:rgba(255,183,159,.26); border-color:rgba(255,183,159,.34); }
.tag-it-traffic{background:rgba(184,177,255,.26); border-color:rgba(184,177,255,.34); }
.tag-it-stay{  background:rgba(127,224,196,.26); border-color:rgba(127,224,196,.34); }
.tag-it-other{ background:rgba(255,159,190,.24); border-color:rgba(255,159,190,.34); }

/* Expense tags (unchanged but more vivid) */
.tag-exp-breakfast{ background:rgba(255,216,122,.30); border-color:rgba(255,216,122,.45); }
.tag-exp-lunch{     background:rgba(255,183,159,.28); border-color:rgba(255,183,159,.42); }
.tag-exp-dinner{    background:rgba(255,159,190,.26); border-color:rgba(255,159,190,.40); }
.tag-exp-snack{     background:rgba(184,177,255,.26); border-color:rgba(184,177,255,.40); }
.tag-exp-stay{      background:rgba(127,224,196,.26); border-color:rgba(127,224,196,.40); }
.tag-exp-flight{    background:rgba(123,183,255,.26); border-color:rgba(123,183,255,.40); }
.tag-exp-rent{      background:rgba(184,177,255,.22); border-color:rgba(184,177,255,.40); }
.tag-exp-parking{   background:rgba(205,215,225,.30); border-color:rgba(125,147,166,.40); }
.tag-exp-fuel{      background:rgba(123,183,255,.20); border-color:rgba(123,183,255,.38); }
.tag-exp-charge{    background:rgba(170,235,240,.24); border-color:rgba(170,235,240,.40); }
.tag-exp-souvenir{  background:rgba(255,159,190,.22); border-color:rgba(255,159,190,.40); }
.tag-exp-ticket{    background:rgba(184,177,255,.22); border-color:rgba(184,177,255,.40); }
.tag-exp-other{     background:rgba(205,215,225,.30); border-color:rgba(125,147,166,.40); }

.link-soft{ text-decoration:underline; text-underline-offset:2px; color:rgba(7,19,31,.86); }

/* Analysis progress */
.progress{
  width:100%;
  height:14px;
  border-radius:999px;
  background:rgba(10,25,45,.14);
  overflow:hidden;
}
.progress-bar{
  height:100%;
  width:0%;
  border-radius:999px;
  background:linear-gradient(90deg, rgba(123,183,255,.95), rgba(127,224,196,.95));
}

/* Modals */
.modal{
  position:fixed;inset:0;
  z-index:60;
  background:rgba(7,19,31,.16);
  backdrop-filter:blur(12px);
  -webkit-backdrop-filter:blur(12px);
  display:flex;align-items:flex-end;justify-content:center;
  padding:14px 14px calc(14px + var(--safe-bottom));
}
.modal.hidden{display:none!important;}
.modal-sheet{
  width:100%;
  max-width:720px;
  border-radius:28px;
  background:var(--glass-strong);
  border:1px solid rgba(10,25,45,.16);
  box-shadow:0 18px 60px rgba(10,25,45,.18);
  overflow:hidden;
}
.modal-head,.modal-foot{
  padding:14px 14px;
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  border-bottom:1px solid rgba(10,25,45,.10);
}
.modal-foot{border-bottom:none;border-top:1px solid rgba(10,25,45,.10);}
.modal-body{
  padding:14px 14px;
  max-height:70vh;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}

/* Pull-to-refresh safe area */
#ptrIndicator{
  top:calc(var(--safe-top) + 6px)!important;
  padding-top:12px!important;
}

/* Expenses page: input-only */
#page-expenses .mt-4{display:none!important;}
#page-expenses .pb-24{padding-bottom:calc(24px + var(--safe-bottom));}

/* Chips */
.chip{
  display:inline-flex;align-items:center;gap:6px;
  padding:8px 10px;border-radius:999px;
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.90);
  color:var(--ink-1);
  font-size:12px;font-weight:900;
}
.chip .x{opacity:.65;font-weight:900;}
