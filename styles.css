:root{
  --bg:#f7fbff;
  --bg2:#f3f8ff;

  --ink:#07121a;
  --ink2:rgba(7,18,26,.78);
  --ink3:rgba(7,18,26,.56);

  --glass:rgba(255,255,255,.78);
  --glass2:rgba(255,255,255,.90);
  --border:rgba(10,25,45,.14);
  --shadow:0 14px 46px rgba(10,25,45,.12);

  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);

  /* Nordics */
  --ice:#7fbfe8;
  --ice-soft:rgba(127,191,232,.16);

  --moss:#5aa785;
  --moss-soft:rgba(90,167,133,.16);

  --amber:#d6a15a;
  --amber-soft:rgba(214,161,90,.16);

  --lav:#7a78d3;
  --lav-soft:rgba(122,120,211,.14);

  --rose:#cf7e95;
  --rose-soft:rgba(207,126,149,.14);

  --slate:#637789;
  --slate-soft:rgba(99,119,137,.12);

  --radius-xl:22px;
  --radius-lg:18px;
  --radius-md:14px;
}

*{box-sizing:border-box;}
html,body{height:100%;}
body{
  margin:0;
  color:var(--ink);
  background:
    radial-gradient(1000px 740px at 18% 0%, rgba(218,242,255,.70) 0%, rgba(218,242,255,0) 56%),
    radial-gradient(900px 680px at 88% 8%, rgba(220,244,233,.62) 0%, rgba(220,244,233,0) 56%),
    linear-gradient(180deg, var(--bg), var(--bg2));
  -webkit-font-smoothing:antialiased;
}

.app-shell{min-height:100vh;display:flex;flex-direction:column;}
.safe-bottom{display:none!important;height:0!important;}

/* Header (safe for Dynamic Island) */
.app-header{
  position:sticky;
  top:0;
  z-index:30;
  padding-top:calc(var(--safe-top) + 18px);
  background:rgba(247,251,255,.88);
  backdrop-filter:blur(16px);
  -webkit-backdrop-filter:blur(16px);
  border-bottom:1px solid rgba(10,25,45,.10);
}
.app-header h1{color:var(--ink)!important;}
.app-header .text-slate-200\/90,
.app-header .text-slate-200\/80,
.app-header .text-slate-50{
  color:var(--ink2)!important;
}

.pill{
  display:inline-flex;align-items:center;gap:8px;
  padding:6px 12px;border-radius:999px;
  font-size:12px;font-weight:800;
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.82);
  color:var(--ink2);
  box-shadow:0 10px 26px rgba(10,25,45,.10);
}
.pill-sky{background:var(--ice-soft);border-color:rgba(127,191,232,.30);color:var(--ink);}
.pill-ice{background:rgba(255,255,255,.88);color:var(--ink);}

.dot{width:10px;height:10px;border-radius:999px;display:inline-block;box-shadow:0 0 0 4px rgba(255,255,255,.92);}
.dot-ok{background:var(--moss);}
.dot-sync{background:var(--ice);}
.dot-offline{background:var(--slate);}
.dot-wait{background:var(--amber);}

/* Content */
.app-content{flex:1;display:flex;flex-direction:column;}

/* Tabbar */
.tabbar{
  position:sticky;
  top:calc(var(--safe-top) + 108px);
  z-index:25;
  padding:10px 12px;
  background:rgba(247,251,255,.84);
  backdrop-filter:blur(16px);
  -webkit-backdrop-filter:blur(16px);
  border-bottom:1px solid rgba(10,25,45,.10);
  display:flex;gap:10px;
}
.tab{
  flex:1;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(10,25,45,.12);
  background:rgba(255,255,255,.78);
  color:var(--ink2);
  font-size:14px;font-weight:900;
}
.tab.active{
  background:rgba(127,191,232,.16);
  border-color:rgba(127,191,232,.30);
  color:var(--ink);
}

/* Cards */
.card{
  background:var(--glass);
  border:1px solid var(--border);
  border-radius:var(--radius-xl);
  box-shadow:var(--shadow);
}

/* Itinerary category card background */
.card-it-sight{ background:linear-gradient(180deg, rgba(127,191,232,.18), rgba(255,255,255,.70)); }
.card-it-food{  background:linear-gradient(180deg, rgba(214,161,90,.18), rgba(255,255,255,.70)); }
.card-it-traffic{background:linear-gradient(180deg, rgba(99,119,137,.14), rgba(255,255,255,.70)); }
.card-it-stay{  background:linear-gradient(180deg, rgba(90,167,133,.18), rgba(255,255,255,.70)); }
.card-it-other{ background:linear-gradient(180deg, rgba(122,120,211,.14), rgba(255,255,255,.70)); }

/* Buttons */
.btn{
  border-radius:999px;
  border:1px solid rgba(10,25,45,.14);
  padding:10px 14px;
  font-weight:900;
  color:var(--ink);
  background:rgba(255,255,255,.82);
  box-shadow:0 10px 26px rgba(10,25,45,.10);
}
.btn:active{transform:translateY(1px);}
.btn-primary{background:rgba(127,191,232,.16);border-color:rgba(127,191,232,.30);}
.btn-outline{background:rgba(255,255,255,.78);}
.btn-ghost{background:transparent;box-shadow:none;}

/* Fields */
.field-label{font-size:12px;font-weight:900;color:var(--ink3);}
.field-input{
  margin-top:6px;width:100%;
  border-radius:var(--radius-md);
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.92);
  padding:12px 12px;
  font-size:14px;
  color:var(--ink);
  outline:none;
}
.field-input:focus{
  border-color:rgba(127,191,232,.42);
  box-shadow:0 0 0 4px rgba(127,191,232,.18);
}

/* ✅ time input narrower to avoid overlap */
.time-input{
  padding:10px 10px;
  font-size:13px;
}

/* Editable */
.editable{
  margin-top:6px;
  min-height:46px;
  padding:12px 12px;
  border-radius:var(--radius-md);
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.92);
  color:var(--ink);
  outline:none;
}
.editable:empty:before{content:attr(placeholder);color:rgba(7,18,26,.40);}

/* Date strip */
.date-strip{
  display:flex;overflow-x:auto;gap:10px;
  padding:6px 2px;
  -webkit-overflow-scrolling:touch;
  scroll-snap-type:x mandatory;
}
.date-strip::-webkit-scrollbar{display:none;}
.date-chip{
  flex:0 0 auto;
  scroll-snap-align:center;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(10,25,45,.12);
  background:rgba(255,255,255,.80);
  font-size:12px;font-weight:900;
  color:var(--ink2);
}
.date-chip.active{
  background:rgba(127,191,232,.16);
  border-color:rgba(127,191,232,.30);
  color:var(--ink);
}

/* Tags */
.tag{
  display:inline-flex;align-items:center;
  padding:8px 12px;
  border-radius:999px;
  font-size:12px;font-weight:900;
  border:1px solid rgba(10,25,45,.12);
  color:var(--ink);
  background:rgba(255,255,255,.78);
}
.tag.active{box-shadow:0 10px 26px rgba(10,25,45,.12);}

/* Itinerary tags */
.tag-it-sight{ background:rgba(127,191,232,.18); border-color:rgba(127,191,232,.30); }
.tag-it-food{  background:rgba(214,161,90,.18); border-color:rgba(214,161,90,.30); }
.tag-it-traffic{background:rgba(99,119,137,.14); border-color:rgba(99,119,137,.26); }
.tag-it-stay{  background:rgba(90,167,133,.18); border-color:rgba(90,167,133,.30); }
.tag-it-other{ background:rgba(122,120,211,.14); border-color:rgba(122,120,211,.26); }

/* Expense category tag colors (per category, not bucket only) */
.tag-exp{
  background:rgba(255,255,255,.82);
}
.tag-exp[data-cat*="早餐"]{ background:rgba(214,161,90,.18); border-color:rgba(214,161,90,.30); }
.tag-exp[data-cat*="午餐"]{ background:rgba(214,161,90,.18); border-color:rgba(214,161,90,.30); }
.tag-exp[data-cat*="晚餐"]{ background:rgba(214,161,90,.18); border-color:rgba(214,161,90,.30); }
.tag-exp[data-cat*="零食"]{ background:rgba(214,161,90,.18); border-color:rgba(214,161,90,.30); }

.tag-exp[data-cat="住宿"]{ background:rgba(90,167,133,.18); border-color:rgba(90,167,133,.30); }

.tag-exp[data-cat*="交通"]{ background:rgba(127,191,232,.18); border-color:rgba(127,191,232,.30); }

.tag-exp[data-cat="門票"]{ background:rgba(122,120,211,.14); border-color:rgba(122,120,211,.26); }
.tag-exp[data-cat="紀念品"]{ background:rgba(207,126,149,.14); border-color:rgba(207,126,149,.26); }
.tag-exp[data-cat="其他"]{ background:rgba(99,119,137,.12); border-color:rgba(99,119,137,.22); }

/* Pending */
.pending-card{border:2px dashed var(--amber)!important;}
.pending-badge{
  padding:2px 8px;border-radius:999px;
  border:1px dashed var(--amber);
  color:var(--amber);
  background:rgba(255,255,255,.76);
  font-weight:900;
}

/* Progress */
.progress{
  width:100%;
  height:12px;
  border-radius:999px;
  background:rgba(10,25,45,.10);
  overflow:hidden;
}
.progress-bar{
  height:100%;
  width:0%;
  border-radius:999px;
  background:linear-gradient(90deg, rgba(127,191,232,.94), rgba(90,167,133,.94));
}

/* Modals */
.modal{
  position:fixed;inset:0;
  z-index:60;
  background:rgba(7,18,26,.16);
  backdrop-filter:blur(12px);
  -webkit-backdrop-filter:blur(12px);
  display:flex;align-items:flex-end;justify-content:center;
  padding:14px 14px calc(14px + var(--safe-bottom));
}
.modal.hidden{display:none!important;}
.modal-sheet{
  width:100%;
  max-width:760px;
  border-radius:28px;
  background:var(--glass2);
  border:1px solid rgba(10,25,45,.16);
  box-shadow:0 18px 60px rgba(10,25,45,.18);
  overflow:hidden;
}
.modal-head,.modal-foot{
  padding:14px 14px;
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  border-bottom:1px solid rgba(10,25,45,.10);
}
.modal-foot{border-bottom:none;border-top:1px solid rgba(10,25,45,.10);}
.modal-body{
  padding:14px 14px;
  max-height:70vh;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}

/* Pull-to-refresh indicator */
#ptrIndicator{
  top:0!important;
  padding-top:calc(var(--safe-top) + 10px)!important;
}

/* Expenses page input-only */
#page-expenses .mt-4{display:none!important;}
#page-expenses .pb-24{padding-bottom:calc(24px + var(--safe-bottom));}

/* Chips */
.chip{
  display:inline-flex;align-items:center;gap:6px;
  padding:8px 10px;border-radius:999px;
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.86);
  color:var(--ink2);
  font-size:12px;font-weight:900;
}
.chip .x{opacity:.65;font-weight:900;}
