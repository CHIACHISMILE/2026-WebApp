/* =========================================================
   2026 冰島挪威之旅 - Nordic Apple-like Theme (v4)
   Fixes:
   - Header safe area (Dynamic Island)
   - Status readable
   - Itinerary cards full tinted by category
   - Analysis numbers/bar more readable
   - Richer palette
   ========================================================= */

:root{
  --bg-0:#f4fbff;
  --bg-1:#eef6ff;

  --ink-0:#061019;
  --ink-1:rgba(6,16,25,.86);
  --ink-2:rgba(6,16,25,.62);
  --ink-3:rgba(6,16,25,.44);

  --glass:rgba(255,255,255,.72);
  --glass-strong:rgba(255,255,255,.88);
  --glass-border:rgba(10,25,45,.14);
  --shadow:0 12px 38px rgba(10,25,45,.10);

  --radius-xl:22px;
  --radius-lg:18px;
  --radius-md:14px;

  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);

  /* Nordic palette (more diverse but elegant) */
  --c-sky:#4a9fd9;
  --c-moss:#3e9a72;
  --c-amber:#d39a4b;
  --c-lav:#6f6dcc;
  --c-rose:#c86f86;
  --c-slate:#556776;
  --c-ice:#bfe9ff;
  --c-mint:#bfead9;
  --c-sand:#f2e6cc;
}

*{box-sizing:border-box;}
html,body{height:100%;}
body{
  margin:0;
  color:var(--ink-0);
  background:
    radial-gradient(1100px 800px at 20% 0%, rgba(215,239,255,.95) 0%, rgba(215,239,255,0) 58%),
    radial-gradient(900px 700px at 85% 10%, rgba(207,242,233,.90) 0%, rgba(207,242,233,0) 58%),
    linear-gradient(180deg, var(--bg-0), var(--bg-1));
  -webkit-font-smoothing:antialiased;
}

.app-shell{min-height:100vh;display:flex;flex-direction:column;}
.safe-bottom{display:none!important;height:0!important;}

/* Header: add extra top padding so it won't go under Dynamic Island */
.app-header{
  position:sticky;
  top:0;
  z-index:30;
  padding-top:calc(28px + var(--safe-top)); /* ⬅️ stronger than before */
  background:linear-gradient(180deg, rgba(244,251,255,.94), rgba(244,251,255,.80));
  backdrop-filter:blur(16px);
  -webkit-backdrop-filter:blur(16px);
  border-bottom:1px solid rgba(10,25,45,.10);
}
.app-header h1{color:var(--ink-0)!important;}
.app-header .text-slate-200\/90,
.app-header .text-slate-200\/80,
.app-header .text-slate-50{color:var(--ink-1)!important;}

.pill{
  display:inline-flex;align-items:center;gap:8px;
  padding:6px 12px;border-radius:999px;
  font-size:12px;font-weight:800;
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.84);
  color:var(--ink-1);
  box-shadow:0 10px 26px rgba(10,25,45,.10);
}
.pill-sky{background:rgba(74,159,217,.18);border-color:rgba(74,159,217,.30);color:var(--ink-0);}
.pill-ice{background:rgba(255,255,255,.88);}

.dot{width:10px;height:10px;border-radius:999px;display:inline-block;box-shadow:0 0 0 3px rgba(255,255,255,.95);}
.dot-ok{background:var(--c-moss);}
.dot-sync{background:var(--c-sky);}
.dot-offline{background:var(--c-slate);}
.dot-wait{background:var(--c-amber);}

/* Make status readable (your complaint #3) */
#syncStatus .text-sm{color:var(--ink-0)!important;font-weight:800;}

.app-content{flex:1;display:flex;flex-direction:column;}

/* Tabbar: move down a bit to avoid overlap on some iPhones */
.tabbar{
  position:sticky;
  top:calc(102px + var(--safe-top));
  z-index:25;
  padding:10px 12px;
  background:rgba(244,251,255,.84);
  backdrop-filter:blur(16px);
  -webkit-backdrop-filter:blur(16px);
  border-bottom:1px solid rgba(10,25,45,.10);
  display:flex;gap:10px;
}
.tab{
  flex:1;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(10,25,45,.12);
  background:rgba(255,255,255,.78);
  color:var(--ink-1);
  font-size:14px;font-weight:900;
}
.tab.active{
  background:rgba(74,159,217,.16);
  border-color:rgba(74,159,217,.30);
  color:var(--ink-0);
}

.card{
  background:var(--glass);
  border:1px solid var(--glass-border);
  border-radius:var(--radius-xl);
  box-shadow:var(--shadow);
}

.btn{
  border-radius:999px;
  border:1px solid rgba(10,25,45,.14);
  padding:10px 14px;
  font-weight:900;
  color:var(--ink-0);
  background:rgba(255,255,255,.82);
  box-shadow:0 10px 26px rgba(10,25,45,.10);
}
.btn:active{transform:translateY(1px);}
.btn-primary{background:rgba(74,159,217,.16);border-color:rgba(74,159,217,.30);}
.btn-outline{background:rgba(255,255,255,.78);}
.btn-ghost{background:transparent;box-shadow:none;}

.field-label{font-size:12px;font-weight:900;color:var(--ink-2);}
.field-input{
  margin-top:6px;width:100%;
  border-radius:var(--radius-md);
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.90);
  padding:12px 12px;
  font-size:14px;
  color:var(--ink-0);
  outline:none;
}
.field-input:focus{
  border-color:rgba(74,159,217,.42);
  box-shadow:0 0 0 4px rgba(74,159,217,.18);
}

/* (2) time boxes shorter */
.time-input{
  width:100%;
  padding:10px 8px;
  font-size:14px;
  letter-spacing:.2px;
}

/* Editable */
.editable{
  margin-top:6px;
  min-height:46px;
  padding:12px 12px;
  border-radius:var(--radius-md);
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.90);
  color:var(--ink-0);
  outline:none;
}
.editable:empty:before{content:attr(placeholder);color:rgba(6,16,25,.40);}

/* Date strip */
.date-strip{
  display:flex;overflow-x:auto;gap:10px;
  padding:6px 2px;
  -webkit-overflow-scrolling:touch;
  scroll-snap-type:x mandatory;
}
.date-strip::-webkit-scrollbar{display:none;}
.date-chip{
  flex:0 0 auto;
  scroll-snap-align:center;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(10,25,45,.12);
  background:rgba(255,255,255,.80);
  font-size:12px;font-weight:900;
  color:var(--ink-1);
}
.date-chip.active{
  background:rgba(74,159,217,.16);
  border-color:rgba(74,159,217,.30);
  color:var(--ink-0);
}

/* Tag */
.tag{
  display:inline-flex;align-items:center;
  padding:8px 12px;
  border-radius:999px;
  font-size:12px;font-weight:900;
  border:1px solid rgba(10,25,45,.12);
  color:var(--ink-0);
}

/* Pending */
.pending-card{border:2px dashed var(--c-amber)!important;}
.pending-badge{
  padding:2px 8px;border-radius:999px;
  border:1px dashed var(--c-amber);
  color:rgba(110,70,10,.92);
  background:rgba(255,255,255,.78);
  font-weight:900;
}

/* (4) Itinerary card full tinted by category */
.it-card{
  border:1px solid rgba(10,25,45,.14);
}
.it-sight{ background:linear-gradient(180deg, rgba(74,159,217,.18), rgba(255,255,255,.68)); }
.it-food{  background:linear-gradient(180deg, rgba(211,154,75,.20), rgba(255,255,255,.68)); }
.it-traffic{background:linear-gradient(180deg, rgba(85,103,118,.16), rgba(255,255,255,.68));}
.it-stay{  background:linear-gradient(180deg, rgba(62,154,114,.18), rgba(255,255,255,.68)); }
.it-other{ background:linear-gradient(180deg, rgba(111,109,204,.16), rgba(255,255,255,.68)); }

/* Itinerary tag palette */
.tag-it-sight{ background:rgba(74,159,217,.20); border-color:rgba(74,159,217,.30); }
.tag-it-food{  background:rgba(211,154,75,.22); border-color:rgba(211,154,75,.32); }
.tag-it-traffic{background:rgba(85,103,118,.18); border-color:rgba(85,103,118,.28); }
.tag-it-stay{  background:rgba(62,154,114,.20); border-color:rgba(62,154,114,.30); }
.tag-it-other{ background:rgba(111,109,204,.18); border-color:rgba(111,109,204,.28); }

/* Expense tag palette (more vivid but still soft) */
.tag-exp-breakfast{ background:rgba(255,210,140,.32); border-color:rgba(211,154,75,.34); }
.tag-exp-lunch{     background:rgba(255,197,120,.28); border-color:rgba(211,154,75,.34); }
.tag-exp-dinner{    background:rgba(255,180,110,.26); border-color:rgba(211,154,75,.34); }
.tag-exp-snack{     background:rgba(255,220,170,.28); border-color:rgba(211,154,75,.34); }
.tag-exp-stay{      background:rgba(191,234,217,.34); border-color:rgba(62,154,114,.34); }
.tag-exp-flight{    background:rgba(203,213,255,.34); border-color:rgba(111,109,204,.34); }
.tag-exp-rent{      background:rgba(179,225,255,.34); border-color:rgba(74,159,217,.34); }
.tag-exp-parking{   background:rgba(210,220,230,.34); border-color:rgba(85,103,118,.30); }
.tag-exp-fuel{      background:rgba(205,235,255,.32); border-color:rgba(74,159,217,.34); }
.tag-exp-charge{    background:rgba(205,245,250,.30); border-color:rgba(74,159,217,.30); }
.tag-exp-souvenir{  background:rgba(255,200,215,.34); border-color:rgba(200,111,134,.34); }
.tag-exp-ticket{    background:rgba(225,214,255,.34); border-color:rgba(111,109,204,.34); }
.tag-exp-other{     background:rgba(220,230,240,.34); border-color:rgba(85,103,118,.30); }

.link-soft{ text-decoration:underline; text-underline-offset:2px; color:rgba(6,16,25,.86); }

/* Analysis progress */
.progress{
  width:100%;
  height:14px;
  border-radius:999px;
  background:rgba(10,25,45,.12);
  overflow:hidden;
}
.progress-bar{
  height:100%;
  width:0%;
  border-radius:999px;
  background:linear-gradient(90deg, rgba(74,159,217,.95), rgba(62,154,114,.95));
}

/* Modals */
.modal{
  position:fixed;inset:0;
  z-index:60;
  background:rgba(6,16,25,.16);
  backdrop-filter:blur(12px);
  -webkit-backdrop-filter:blur(12px);
  display:flex;align-items:flex-end;justify-content:center;
  padding:14px 14px calc(14px + var(--safe-bottom));
}
.modal.hidden{display:none!important;}
.modal-sheet{
  width:100%;
  max-width:720px;
  border-radius:28px;
  background:var(--glass-strong);
  border:1px solid rgba(10,25,45,.16);
  box-shadow:0 18px 60px rgba(10,25,45,.18);
  overflow:hidden;
}
.modal-head,.modal-foot{
  padding:14px 14px;
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  border-bottom:1px solid rgba(10,25,45,.10);
}
.modal-foot{border-bottom:none;border-top:1px solid rgba(10,25,45,.10);}
.modal-body{
  padding:14px 14px;
  max-height:70vh;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}

/* Pull-to-refresh indicator safe area */
#ptrIndicator{
  top:calc(var(--safe-top) + 6px)!important;
  padding-top:10px!important;
}

/* Expenses page: input-only */
#page-expenses .mt-4{display:none!important;}
#page-expenses .pb-24{padding-bottom:calc(24px + var(--safe-bottom));}

/* Chips */
.chip{
  display:inline-flex;align-items:center;gap:6px;
  padding:8px 10px;border-radius:999px;
  border:1px solid rgba(10,25,45,.14);
  background:rgba(255,255,255,.86);
  color:var(--ink-1);
  font-size:12px;font-weight:900;
}
.chip .x{opacity:.65;font-weight:900;}
